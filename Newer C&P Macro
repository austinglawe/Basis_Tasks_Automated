Sub ConsolidateReports()
    Dim file_path As String
    Dim file_path_count As Integer
    Dim home_column_a_max As Long
    Dim reports_column_a_max As Long
    Dim current_file_name As String
    Dim wsHome As Worksheet
    Dim wsAllReports As Worksheet
    Dim wsTemp As Worksheet
    Dim i As Integer

    ' Prompt the user for a file path
    file_path = InputBox("Please input a file path to consolidate the reports.")

    ' Check if the file path exists
    If Dir(file_path, vbDirectory) = "" Then
        MsgBox "I'm sorry, this file path does not exist. To try again, re-run the macro with a new file path.", vbExclamation
        Exit Sub
    End If

    ' Set references to worksheets
    Set wsHome = ThisWorkbook.Sheets("Home")
    Set wsAllReports = ThisWorkbook.Sheets("All Reports Combined")

    ' Check if A1 in Home sheet is "File Name" and B1 is "Completed"
    If wsHome.Cells(1, 1).Value <> "File Name" Then
        wsHome.Cells(1, 1).Value = "File Name"
    End If
    If wsHome.Cells(1, 2).Value <> "Completed" Then
        wsHome.Cells(1, 2).Value = "Completed"
    End If


  ' Check "All Reports Completed" sheet if A1 is "Sweep_ID", B1 is "Order_Number", C1 is "C&P_Transaction_Date", D1 is "C&P_Fund_Date", E1 is "First_Name", F1 is "Last_Name",
  ' G1 is "Gross_Amount", H1 is "Per_Transaction_Fees", I1 is "Discount Fees", J1 is "Net_Amount", K1 is "Order_Number_Trimmed", L1 is "Transaction_Date", M1 is "Fund_Date",
  ' N1 is "CNP_School_ID", O1 is "CNP_School_ID-Sweep_ID", P1 is "File_Name", Q1 is "School_ID-Transaction_Date", and R1 is "School_ID-Fund_Date"


    If wsAllReports.Cells(1, 1).Value <> "Sweep_ID" Then
        wsAllReports.Cells(1, 1).Value = "Sweep_ID"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Order_Number" Then
        wsAllReports.Cells(1, 1).Value = "Order_Number"
    End If
    If wsAllReports.Cells(1, 1).Value <> "C&P_Transaction_Date" Then
        wsAllReports.Cells(1, 1).Value = "C&P_Transaction_Date"
    End If
    If wsAllReports.Cells(1, 1).Value <> "C&P_Fund_Date" Then
        wsAllReports.Cells(1, 1).Value = "C&P_Fund_Date"
    End If
    If wsAllReports.Cells(1, 1).Value <> "First_Name" Then
        wsAllReports.Cells(1, 1).Value = "First_Name"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Last_Name" Then
        wsAllReports.Cells(1, 1).Value = "Last_Name"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Gross_Amount" Then
        wsAllReports.Cells(1, 1).Value = "Gross_Amount"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Per_Transaction_Fees" Then
        wsAllReports.Cells(1, 1).Value = "Per_Transaction_Fees"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Discount Fees" Then
        wsAllReports.Cells(1, 1).Value = "Discount Fees"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Net_Amount" Then
        wsAllReports.Cells(1, 1).Value = "Net_Amount"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Order_Number_Trimmed" Then
        wsAllReports.Cells(1, 1).Value = "Order_Number_Trimmed"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Transaction_Date" Then
        wsAllReports.Cells(1, 1).Value = "Transaction_Date"
    End If
    If wsAllReports.Cells(1, 1).Value <> "Fund_Date" Then
        wsAllReports.Cells(1, 1).Value = "Fund_Date"
    End If
    If wsAllReports.Cells(1, 1).Value <> "CNP_School_ID" Then
        wsAllReports.Cells(1, 1).Value = "CNP_School_ID"
    End If
    If wsAllReports.Cells(1, 1).Value <> "CNP_School_ID-Sweep_ID" Then
        wsAllReports.Cells(1, 1).Value = "CNP_School_ID-Sweep_ID"
    End If
    If wsAllReports.Cells(1, 1).Value <> "File_Name" Then
        wsAllReports.Cells(1, 1).Value = "File_Name"
    End If
    If wsAllReports.Cells(1, 1).Value <> "School_ID-Transaction_Date" Then
        wsAllReports.Cells(1, 1).Value = "School_ID-Transaction_Date"
    End If
    If wsAllReports.Cells(1, 1).Value <> "School_ID-Fund_Date" Then
        wsAllReports.Cells(1, 1).Value = "School_ID-Fund_Date"
    End If



    ' Get the file count in the specified directory
    file_path_count = 0
    Dim file As String
    file = Dir(file_path & "\*.*")
    Do While file <> ""
        file_path_count = file_path_count + 1
        file = Dir
    Loop

    ' Check if the file_path_count is less than 1
    If file_path_count < 1 Then
        Exit Sub
    End If

    ' Loop through each file in the directory
    file = Dir(file_path & "\*.*")
    Do While file <> ""
        ' Set current_file_name to the file name
        current_file_name = file

        ' Find the last row in column A of the Home sheet
        home_column_a_max = wsHome.Cells(wsHome.Rows.Count, 1).End(xlUp).Row

        ' Place current_file_name in column A below where the data ends
        wsHome.Cells(home_column_a_max + 1, 1).Value = current_file_name

        ' Find the last row in column A of the All Reports Combined sheet
        reports_column_a_max = wsAllReports.Cells(wsAllReports.Rows.Count, 1).End(xlUp).Row

        ' Open the file and copy rows 14 to the end of the data
        Set wsTemp = Workbooks.Open(file_path & "\" & file).Sheets(1)
        wsTemp.Rows("14:" & wsTemp.Cells(wsTemp.Rows.Count, 1).End(xlUp).Row).Copy wsAllReports.Cells(reports_column_a_max + 1, 1)

        ' Put current_file_name in column P for all the copied rows
        wsAllReports.Range("P" & reports_column_a_max + 1 & ":P" & reports_column_a_max + (wsTemp.Cells(wsTemp.Rows.Count, 1).End(xlUp).Row - 13)).Value = current_file_name

        ' Close the opened file
        wsTemp.Parent.Close

        ' Put an "x" in column B next to the file path name in Home sheet
        wsHome.Cells(home_column_a_max + 1, 2).Value = "x"

        ' Move to the next file
        file = Dir
    Loop
End Sub
